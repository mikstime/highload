Часть 1. Оценка аудитории и нагрузки
=================

## Оценка месячной аудитории

Основная аудитория проекта – школьники, студенты и преподаватели.

Таблица 1. Целевая аудитория

| Школьники | Студенты | Преподаватели |
| --------- | -------- | ------------- |
| 16.1 млн  | 7.2 млн  | 1.1 млн       |

Таким образом, потенциальная аудитория в России составляет около 
**24 млн. человек** _(16,7% от населения РФ)_.

Наличии государственной поддержки, а также увеличение цифрализации 
учебных заведений во время всеобщей самоизоляции позволят охватить 
значительную часть аудитории.

С учетом уровня проникновения Интернета в 100% среди молодежи, итоговая аудитория
проекта будет составлять те же **24 млн человек**.

## Ежедневная аудитория

Согласно рекомендациям Роспотребнадзора, компьютерная сессия для школьников 
должна составлять от 15 до 30 минут. Исходя из среднего количества уроков в 
день и пятидневной недели, средний школьник будет пользоваться сервисом 
около **70 минут в день**.

Ежедневно все студенты, школьники и преподаватели будут использовать приложение, 
поэтому ежедневная аудитория сопоставима с общей и составляет **24 млн. чел**.

###### В выходные и праздничные дни нагрузка на проект значительно падает.

## Планируемая нагрузка

В течение дня ученик посещает 5 уроков. За это время он просматривает 
5 текстовых материалов, 5 видеоматериалов и проходит 5 тестов.

Предположим, что средний урок содержит в себе около 10 картинок, 500 слов и 10 минут видео материала.
Тогда текстовый материал весит около Кб, 10 картинок – 3Мб, 10 минут full hd видео – 79мб.

###### Обоснование размера приведено в следующей секции

Средняя скорость широкополосного интернета на загрузку по России: 38 Мбит/с. 
Тогда можно считать, что скорости интернета у среднего ученика, использующего
компьютер, достаточно для просмотра full hd видео.

Средняя скорость мобильного интернета на загрузку по России 16 Мбит/c.
Тогда можно считать, что скорости интернета у среднего ученика, использующего
телефон, также достаточно для просмотра full hd видео.

Сделаем допущение, что средний ученик смотрит видео в формате full hd.

Таким образом, хороший ученик потребляет около 450 Мб материала в течение дня, 
а плохой – 3 Мб. Тогда, предположительно, средний ученик будет 
потреблять 50Мб контента.

Общий трафик за день: **1350 ТБ**.

## Объем хранимого материала

Оценим место, которое занимает один урок
###### Числа получины за счет апроксимации размеров материалов на coursera

| Качество  | Занимаемое место (10 мин) |
| :-------- | :-----------------------: |
|   540p    |           17 МБ           |
|   720p    |           45 МБ           |
|   1080p   |           79 МБ           |

Проссуммировав, получаем, что средний урок весит **141 МБ**.

Пусть для простоты лекции для студентов не содержат видео, 
тогда можно предположить, что объем всех образовательных программ 
студентов за год сопоставим с годом школьной прогрммы. 
Обучение студента длится 4 года. Тогда с учетом выходных получаем общий объем
видео-материала:

273\*5\*(11 + 4) \* 0.141 ~ **2.9 ТБ**

###### Заметим, что на небольшой объем данных приходится большая часть трафика

При этом также необходимо хранить информацию о тестах, которые проходят ученики

Пусть часть заданий содержат текстовые эссэ, часть требует отправки картинок, 
часть – простой выбор ответа.

Тогда можно предположить средний объем теста в 300 кб (1 фото на тест).

Ежедневно ученики проходят 5 \* 27 млн тестов ~ **38,5 ТБ** материала 
(Примерно 3.65 Гбит/сек).

Оптимальное решение – хранить результаты теста 2 года, таким образом, 
за два учебных года будет накоплено **21000 ТБ** материала, 
и будет сохранять около постоянный объем.

###### Заметим, что есть большой объем данных, которые редко читаются. При этом их читают как правило в течение небольшого времени с момента загрузки (большинство работ проверяется в течение месяца). 

## Моментальная пиковая нагрузка

Значительная часть населения России живет по Москвоскому времени, 
большая часть школьников учится в дневное время, поэтому можно предположить 
пик нагрузки в период с 8:30 до 13:00 по МСК.

Предположим, что занятия длятся 4,5 часа. 
Относительно Москвы часовые пояса изменяются от -1 до +9.
Учитывая, что занятия начинаются в примерно одно время, и наиболее населенный 
пояс содержит Москву, то 
нас интересует число обучающихся в поясах от -1, 0, +1, +2 и +4. 
Данные пояса охватывают примерно **60%** населения. Пусть также 10% пропустит
занятия.
 
Число активных пользователей при пиковой нагрузке: 

A = 27млн \* 0.6 \* 0.9= **14.6 млн**

Взяв значение для произвольного курса на coursera, получаем примерный битрейт

|   Качество   | Битрейт webm | Битрейт mp4  | Примерная доля |
| :----------- | :----------: | :----------: | :------------: |
|  low (540p)  | 62 Кбит/сек  | 208 Кбит/сек |      10%       |
|  mid (720p)  | 75 Кбит/сек  | 322 Кбит/сек |      20%       |
| high (1080p) |      -       |       -      |      70%       |

Если учесть, что h264 для видео в 1080p на youtube имеет в 1.66 раз больший битрейт, 
то можно предположить, что для coursera этот показатель будет равен `534 Кбит/сек`

Аналогично для webm имеем 75 \* 1.75 = `132 Кбит/сек`

Таким образом,

|   Качество   | Битрейт webm | Битрейт mp4  | Примерная доля |
| :----------- | :----------: | :----------: | :------------: |
|  low (540p)  | 62 Кбит/сек  | 208 Кбит/сек |      10%       |
|  mid (720p)  | 75 Кбит/сек  | 322 Кбит/сек |      20%       |
| high (1080p) | 132 Кбит/сек | 534 Кбит/сек |      70%       |

Формат `webm` не поддерживается в safari, доля пользователей браузера safari 
составляет примерно 10%, для данных пользователей будет использован `mp4`.

Тогда средний битрейт будет примерно равен 

0.9 \* (132 \* 0.7 + 75 \* 0.2 + 62 \* 0.1) + 0.1 \* (534 \* 0.7 + 322 \* 
0.2 + 208 \* 0.1) ~ **150 Кбит/сек**

Учтем, что время начала просмотра видео равномерно распределено в течение часа, 
а также то, что средний ученик смотрит лишь пятую часть видеоурока.

Тогда ширина полосы пропускания при среднем битрейте 150 Кбит/сек

BW = 14.6 млн \* 0.146 Мб/сек / 6 / 5 = **70 Гбит/сек**

## Используемые материалы:

[Образование в цифрах: 2019](https://www.hse.ru/data/2019/08/12/1483728373/oc2019.PDF)

[Аудитория рунета](https://cloud.mail.ru/public/TQZu/3gjz8ELsd)

[Место, которое занимает час видео](https://www.androidauthority.com/how-much-data-does-netflix-use-976146/)

[Средняя скорость интернета](https://www.speedtest.net/reports/ru/russia/#fixed)

[Нормы выполнения работы за компьютером](http://04.rospotrebnadzor.ru/index.php/press-center/healthy-lifestyle/13188-07092020.html)

[Часовым пояса России](http://www.issp.ac.ru/astro/time/2002/020501.html)

[Оценка битрейта](https://toolstud.io/video/filesize.php?dimensions_w=1920&dimensions_h=1080&framerate=24&timeduration=4260&timeduration_unit=seconds)

[Поддержка webm](https://caniuse.com/webm)

[Поддержка mp4](https://caniuse.com/?search=mp4)

[Популярность браузеров](http://alexvaleev.ru/browserstat/)

[Битрейт видео youtube](https://www.tutorialguidacomefare.com/test-video-quality-720p-1080p-1440p-2160p-max-bitrate-which-compresses-youtube/)

[Произвольный курс на coursera](https://www.coursera.org/lecture/algorithms-part2/introduction-to-data-compression-OtmHU)